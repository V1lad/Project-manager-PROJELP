{% extends "base.html" %}

{% block title %}–ü—Ä–æ–µ–∫—Ç{% endblock %}
{% block content %}

<ul class="list-group mt-4">
    {% for note in subproject.notes %}
    <li class="list-group-item bg-dark-2 text-light mb-3 border rounded-3 shadow-lg {% if note.status == 'done' %}border-success
        {% elif note.status == 'in_progress' %}border-primary
        {% elif note.status == 'abandoned' %}border-secondary
        {% else %}border-info{% endif %}">
        
        <!-- –ï–¥–∏–Ω–∞—è —Ñ–æ—Ä–º–∞ -->
        <form method="POST" id="note-form-{{ note.id }}">
            <input type="hidden" name="note_id" value="{{ note.id }}">
            
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å -->
            <div class="d-flex justify-content-between align-items-center mb-3">
                <input type="text" 
                       class="form-control bg-dark-2 text-light  h4 w-50 {% if note.status == 'done' %}border-success
                    {% elif note.status == 'in_progress' %}border-primary
                    {% elif note.status == 'abandoned' %}border-secondary
                    {% else %}border-info{% endif %}"
                       name="title" 
                       value="{{ note.title }}">
                
                <div class="text-end">
                    <div class="text-info fw-bold">
                        üìà {{ note.progress }}%
                    </div>

                    <div class="text-info fw-bold">
                       {% if note.planned_at  %} ‚è≥ {{ get_date(note.planned_at) }} {% endif %}
                    </div>
                </div>
            </div>

            <!-- –¢–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏ -->
            <div class="mb-3 position-relative">
                <textarea class="form-control bg-dark-2 text-light auto-resize 
                            {% if note.status == 'done' %}border-success
                            {% elif note.status == 'in_progress' %}border-primary
                            {% elif note.status == 'abandoned' %}border-secondary
                            {% else %}border-info{% endif %}" 
                          name="content">{{ note.content }}</textarea>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <div class="d-flex justify-content-between align-items-center gap-2">
                <!-- –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è -->
                <button type="submit" name="save_button" class="btn btn-sm btn-outline-info">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>

                <!-- –ì—Ä—É–ø–ø–∞ –∫–Ω–æ–ø–æ–∫ —Å–ø—Ä–∞–≤–∞ -->
                <div class="d-flex gap-2">
                    <!-- –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ -->
                    <button type="submit" 
                            name="status_button"
                            class="btn btn-sm 
                                {% if note.status == 'done' %}btn-success
                                {% elif note.status == 'in_progress' %}btn-primary
                                {% elif note.status == 'abandoned' %}btn-secondary
                                {% else %}btn-info{% endif %}">
                        {% if note.status == 'done' %}‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ
                        {% elif note.status == 'in_progress' %}‚è≥ –í —Ä–∞–±–æ—Ç–µ
                        {% elif note.status == 'abandoned' %}‚è∏Ô∏è –û—Ç–ª–æ–∂–µ–Ω–æ
                        {% else %}üïë –ù–µ –Ω–∞—á–∞—Ç–∞ {% endif %}
                    </button>

                    <button class="btn btn-sm btn-outline-purple" 
                            name="planning_button">
                        üìÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
                    </button>

                    <button class="btn btn-sm btn-outline-purple" 
                            name="comments_button">
                        üí¨ {{ note.chatRoom.messages | length }} –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
                    </button>

                    <button type="submit" 
                            name="delete_button" 
                            class="btn btn-sm btn-outline-danger">
                        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                    </button>
                </div>
            </div>
        </form>

    </li>
    {% endfor %}
</ul>

<style>


    .auto-resize {
        min-height: 3.7lh;
        resize: none;
        transition: all 0.3s;
    }
    .auto-resize:focus {
        box-shadow: 0 0 0 0.25rem rgba(111, 66, 193, 0.25);
    }
    .colorp {
        color: #6f42c1;
    }
    /* –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
    .flex-shrink-0 {
        flex-shrink: 0;
    }

    .gap-3 {
        gap: 1rem;
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è */
    @media (max-width: 576px) {
        .d-flex {
            flex-direction: column;
        }
        
        .flex-shrink-0 {
            width: 100%;
        }
    }
    
</style>
<div class="list-group mt-1 mb-2">
    <div class="list-group-item bg-dark-2 text-light rounded-3 border-purple shadow-lg">
        <form action = {{ url_for('.showSubProject', index=project.id, subproject=subproject.id) }} method="POST" class="d-flex align-items-center gap-3">
            <input type="text" 
                   class="form-control bg-dark-2 text-light border-purple" 
                   name="create_note"
                   placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏"
                   required>
            <button type="submit" 
                    class="btn btn-purple flex-shrink-0" 
                    name="create">
                –°–æ–∑–¥–∞—Ç—å
            </button>   
        </form>
    </div>
</div>
<form action = {{ url_for('.showProject', index=project.id) }} method = "POST">
<input type="hidden" name="project" value="{{ project.id }}" />
<button type="submit" class="btn btn-purple mt-3 mb-3"> –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–æ–µ–∫—Ç—É</button>
<br/>
</form>


{% endblock %}