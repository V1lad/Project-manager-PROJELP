{% extends "base.html" %}

{% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–µ–π{% endblock %}
{% block content %}

<div class="list-group mt-4">
    <div class="list-group-item bg-dark-2 text-light mb-3 border rounded-3 shadow-lg border-purple">
        <h4 class="colorp mb-4">‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–µ–π</h4>
        <form method="POST">
            <input type="hidden" name="note_id" value="{{ note.id }}">

            <!-- –í–µ—Ä—Ö–Ω–∏–π —Ä—è–¥: –ü—Ä–æ–≥—Ä–µ—Å—Å –∏ –≤–∞–∂–Ω–æ—Å—Ç—å -->
            <div class="row mb-4 g-3">
                <div class="col-md-8">
                    <label class="form-label colorp">üìà –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                    <div class="input-group">
                        <input type="number" min="0" max="100" 
                               class="form-control bg-dark-2 text-light border-purple" 
                               name="progress" 
                               value="{{ note.progress }}">
                        <span class="input-group-text bg-dark-2 border-purple text-light">%</span>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <label class="form-label colorp">‚öñÔ∏è –ú–Ω–æ–∂–∏—Ç–µ–ª—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</label>
                    <div class="input-group">
                        <input type="number" min="1" max="100" 
                               class="form-control bg-dark-2 text-light border-purple" 
                               name="progress_coefficient" 
                               value="{{ note.progress_coefficient }}">
                    </div>
                </div>
            </div>

            <!-- –¢—Ä–µ—Ç–∏–π —Ä—è–¥: –î–∞—Ç–∞ –∏ —Å—Ç–∞—Ç—É—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
            <div class="row mb-4 g-3">
                <div class="col-md-6">
                    <label class="form-label colorp">üìÖ –î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è</label>
                    <input type="date" class="form-control bg-dark-2 text-light border-purple" 
                           name="planned_at" value="{{ note.planned_at }}">
                </div>
                
                <div class="col-md-6">
                    <label class="form-label colorp">üîî –¢–µ–∫—É—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</label>
                    <div class="input-group">
                        <span class="input-group-text bg-dark-2 border-purple text-light">
                            {% if note.notifications_enabled == "True" %}‚úÖ{% else %}‚ùå{% endif %}
                        </span>
                        <input type="text" class="form-control bg-dark-2 text-light border-purple" 
                               value="{% if notification %} {{ get_date(notification.planned_at) }} {% else %}–í—Ä–µ–º—è –Ω–µ –∑–∞–¥–Ω–æ{% endif %}" 
                               readonly>
                    </div>
                </div>
            </div>

            <!-- –ß–µ—Ç–≤—ë—Ä—Ç—ã–π —Ä—è–¥: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
            <div class="row mb-4 g-3">
                <div class="col-md-6">
                    <label class="form-label colorp">‚è∞ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</label>
                    <select class="form-select bg-dark-2 text-light border-purple" 
                            name="notification_time">
                        <option value="60">–ó–∞ 1 —á–∞—Å</option>
                        <option value="720">–ó–∞ 12 —á–∞—Å–æ–≤</option>
                        <option value="1440">–ó–∞ 24 —á–∞—Å–∞</option>
                        <option value="4320">–ó–∞ 3 –¥–Ω—è</option>
                        <option value="10080">–ó–∞ 7 –¥–Ω–µ–π</option>
                    </select>
                </div>

                <div class="col-md-6">
                    <div class="row g-3 align-items-end">
                        <!-- –ü–µ—Ä–≤–∞—è –∫–Ω–æ–ø–∫–∞ -->
                        <div class="col-4">
                            <button type="submit" name="create_notification" 
                                    class="btn btn-outline-purple w-100">
                                –°–æ–∑–¥–∞—Ç—å
                            </button>
                        </div>

                        <!-- –í—Ç–æ—Ä–∞—è –∫–Ω–æ–ø–∫–∞ —Å –ª–µ–π–±–ª–æ–º -->
                        <div class="col-8">
                            <label class="form-label colorp">üöÄ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</label>
                            <button type="submit" name="change_notification_status" 
                                    class="btn btn-outline-purple w-100">
                                {% if note.notifications_enabled == "True" %} –ó–∞–ø—Ä–µ—Ç–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è {% else %}–†–∞–∑—Ä–µ—à–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è{% endif %}
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <div class="d-flex gap-3 mt-4">
                <button type="submit" name="save_button" class="btn btn-purple">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                </button>
                <a href="{{ url_for('projects.showSubProject', index=project.id, subproject=subproject.id) }}" 
                   class="btn btn-purple ml-3">
                 –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–∞–∑–¥–µ–ª—É
                </a>
            </div>
        </form>
    </div>
</div>

<style>
    .btn-outline-primary { border-color: #0d6efd; color: #0d6efd; }
    .btn-outline-info { border-color: #0dcaf0; color: #0dcaf0; }
    .btn-outline-warning { border-color: #ffc107; color: #ffc107; }
    .btn-outline-danger { border-color: #dc3545; color: #dc3545; }
    .btn-outline-dark { border-color: #212529; color: #212529; }
    
    .input-group-text,
    .form-control[readonly] {
        background-color: #2a2a2a;
        border-color: #6f42c1;
    }
    
    .h-100 { height: calc(100% - 15px); }
</style>

{% endblock %}